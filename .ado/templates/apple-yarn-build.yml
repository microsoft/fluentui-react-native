parameters:
  platform: ''

steps:
  # Install any pods necessary for the project
  - bash: |
      echo "pod install $(platform)"
      pod install
    workingDirectory: apps/fluent-tester/$(platform)
    displayName: 'pod install $(platform)'

  - bash: |
      echo "Pre boot simulator"
      UDID=$(xcrun simctl create test-iphone com.apple.CoreSimulator.SimDeviceType.iPhone-12 iOS15.5)
      xcrun simctl boot $UDID
    workingDirectory: apps/fluent-tester
    condition: and(succeeded(), eq('${{ parameters.platform }}', 'ios'))
    displayName: 'Boot simulator'

  - bash: |
      echo "yarn $(platform)"
      yarn $(platform)
    workingDirectory: apps/fluent-tester
    displayName: 'yarn $(platform)'
