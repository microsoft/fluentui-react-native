steps:
  - checkout: self
    persistCredentials: true

  - template: setup-repo-min-build.yml

  - script: |
      yarn bundle
    workingDirectory: apps/win32
    displayName: 'Bundling win32'

  # Pack the NuGet package
  - task: CmdLine@1
    displayName: 'Create NuGet package for Win32 FluentTester bundle.'
    inputs:
        filename: nuget
        arguments: 'pack Microsoft.FluentUI.FluentTesterWin32.nuspec -OutputDirectory $(Build.ArtifactStagingDirectory)/nuget -OutputFileNamesWithoutVersion -Verbosity detailed -Version $(Build.BuildNumber)'
        workingFolder: 'apps/win32/nuget'

  # push the package package
  - task: NuGetCommand@2
    displayName: 'Publish NuGet package'
    inputs:
      command: push
      packagesToPush: '$(Build.ArtifactStagingDirectory)/nuget/'
      nuGetFeedType: external
      publishFeedCredentials: react-native
